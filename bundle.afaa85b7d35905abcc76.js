(()=>{"use strict";var e={56:(e,n,t)=>{e.exports=function(e){var n=t.nc;n&&e.setAttribute("nonce",n)}},72:e=>{var n=[];function t(e){for(var t=-1,r=0;r<n.length;r++)if(n[r].identifier===e){t=r;break}return t}function r(e,r){for(var o={},i=[],s=0;s<e.length;s++){var l=e[s],c=r.base?l[0]+r.base:l[0],d=o[c]||0,p="".concat(c," ").concat(d);o[c]=d+1;var h=t(p),u={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==h)n[h].references++,n[h].updater(u);else{var m=a(u,r);r.byIndex=s,n.splice(s,0,{identifier:p,updater:m,references:1})}i.push(p)}return i}function a(e,n){var t=n.domAPI(n);t.update(e);return function(n){if(n){if(n.css===e.css&&n.media===e.media&&n.sourceMap===e.sourceMap&&n.supports===e.supports&&n.layer===e.layer)return;t.update(e=n)}else t.remove()}}e.exports=function(e,a){var o=r(e=e||[],a=a||{});return function(e){e=e||[];for(var i=0;i<o.length;i++){var s=t(o[i]);n[s].references--}for(var l=r(e,a),c=0;c<o.length;c++){var d=t(o[c]);0===n[d].references&&(n[d].updater(),n.splice(d,1))}o=l}}},113:e=>{e.exports=function(e,n){if(n.styleSheet)n.styleSheet.cssText=e;else{for(;n.firstChild;)n.removeChild(n.firstChild);n.appendChild(document.createTextNode(e))}}},208:(e,n,t)=>{t.d(n,{A:()=>s});var r=t(601),a=t.n(r),o=t(314),i=t.n(o)()(a());i.push([e.id,"/* =========================================\n   GLOBAL RESET\n   ========================================= */\n*,\n*::before,\n*::after {\n  border: none;\n  box-sizing: border-box;\n  margin: 0;\n  padding: 0;\n}\n\n/* =========================================\n   GLOBAL COLOR VARIABLES\n   ========================================= */\n:root {\n  --battleship-body-bg-color: #0D1B1E;\n  --battleship-accent-color: #88B8E6;\n  --battleship-ship-color: #71ACD1;\n  --battleship-cell-color: #75A9E1;\n  --battleship-hit-color: #E53935;\n  --battleship-miss-color: #CBB2F0;\n  --battleship-ship-valid-dropzone: #39FF14;\n  --battleship-ship-invalid-dropzone: var(--battleship-hit-color);\n}\n\n/* =========================================\n   BASE PAGE & BODY STYLING\n   ========================================= */\nhtml,\nbody {\n  font-family: \"Orbitron\", sans-serif;\n  font-optical-sizing: auto;\n  font-weight: 900;\n}\n\nbody {\n  display: flex;\n  flex-direction: column;\n  position: relative;\n  align-items: center;\n  justify-content: center;\n  min-height: 100vh;\n  background-color: var(--battleship-body-bg-color);\n}\n\nbody::after {\n  content: '';\n  height: 50px;\n}\n\n/* =========================================\n   MAIN CONTAINER LAYOUT\n   ========================================= */\n.main-container {\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n  gap: 5rem;\n  margin-top: 3rem;\n}\n\n.main-container__message {\n  color: var(--battleship-accent-color);\n  font-size: 2.5rem;\n  text-align: center;\n  text-shadow:\n    0 0 8px var(--battleship-accent-color),\n    0 0 0px var(--battleship-accent-color),\n    0 0 1px var(--battleship-accent-color);\n}\n\n.main-container__game {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  gap: 5rem;\n}\n\n/* =========================================\n   PLAYER BOARD STYLING\n   ========================================= */\n.player-board {\n  display: grid;\n  grid-template-columns: repeat(10, 40px);\n  gap: 0.5rem;\n  padding: 0.5rem;\n  position: relative;\n  background-color: var(--battleship-body-bg-color);\n  border-radius: 1rem;\n  transition: transform 0.2s ease, opacity 0.2s ease, filter 0.2s ease;\n}\n\n.player-board--attackable {\n  transform: scale(1.02);\n  box-shadow: 0 0 24px var(--battleship-accent-color);\n  opacity: 1;\n  filter: none;\n}\n\n.player-board--protected {\n  opacity: 0.5;\n  filter: grayscale(50%);\n  pointer-events: none;\n}\n\n/* =========================================\n   PLAYER BOARD CELLS\n   ========================================= */\n.player-board__cell {\n  position: relative;\n  z-index: 0;\n  width: 40px;\n  height: 40px;\n  background-color: transparent;\n  border: 2px solid var(--battleship-cell-color);\n  border-radius: 0.3rem;\n}\n\n.two-player-mode .player-board .player-board__cell:not(.player-board__cell--hit):not(.player-board__cell--miss):hover {\n  background-color: var(--battleship-accent-color);\n  border: none;\n  box-shadow: 0 0 4px var(--battleship-accent-color), 0 0 8px var(--battleship-accent-color);\n  outline: 1px solid var(--battleship-accent-color);\n  cursor: crosshair;\n  transition: all 0.2s ease-in-out;\n}\n\n.player-board[data-player=\"2\"] .player-board__cell:not(.player-board__cell--hit):not(.player-board__cell--miss):hover {\n  background-color: var(--battleship-accent-color);\n  border: none;\n  box-shadow: 0 0 4px var(--battleship-accent-color), 0 0 8px var(--battleship-accent-color);\n  outline: 1px solid var(--battleship-accent-color);\n  cursor: crosshair;\n  transition: all 0.2s ease-in-out;\n}\n\n/* =========================================\n   SHIP SEGMENTS\n   ========================================= */\n.player-board__cell--ship,\n.ship__segment {\n  width: 40px;\n  height: 40px;\n  background-color: var(--battleship-ship-color);\n  border-radius: 0.3rem;\n  box-shadow:\n    0 0 16px var(--battleship-ship-color),\n    0 0 8px var(--battleship-ship-color);\n}\n\n.ship--draggable {\n  display: flex;\n  gap: 0.5rem;\n  width: fit-content;\n  cursor: grab;\n}\n\n.ship--dragging {\n  opacity: 0.7;\n  cursor: grabbing;\n}\n\n/* =========================================\n   DOCK CONTAINER\n   ========================================= */\n.dock-container {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  gap: 1rem;\n}\n\n.dock-container__shipyard {\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  padding: 2rem;\n  height: 35vh;\n  width: 296px;\n  gap: 1rem;\n  background-color: transparent;\n  border-radius: 0.3rem;\n  box-shadow: 0 0 5px var(--battleship-accent-color);\n}\n\n.dock-container__actions {\n  display: flex;\n  align-self: center;\n  gap: 1rem;\n}\n\n.dock-controls__actions {\n  align-self: center;\n}\n\n/* =========================================\n   BUTTON STYLING\n   ========================================= */\n.battleship__button {\n  padding: 0.4rem 0.8rem;\n  font-size: 0.9rem;\n  font-weight: 900;\n  text-transform: uppercase;\n  letter-spacing: 0.5px;\n  border-radius: 0.3rem;\n  border: 1.5px solid var(--battleship-accent-color);\n  cursor: pointer;\n  transition: all 0.15s ease-in-out;\n  color: var(--battleship-body-bg-color);\n  background-color: var(--battleship-accent-color);\n  box-shadow:\n    0 0 4px var(--battleship-accent-color),\n    0 0 8px var(--battleship-accent-color);\n}\n\n.battleship__button:hover {\n  background-color: var(--battleship-body-bg-color);\n  color: var(--battleship-accent-color);\n  box-shadow:\n    0 0 6px var(--battleship-accent-color),\n    0 0 12px var(--battleship-accent-color);\n  transform: scale(1.03);\n}\n\n.battleship__button:active {\n  box-shadow: 0 0 3px var(--battleship-accent-color);\n  transform: scale(0.97);\n}\n\n/* =========================================\n  HIT / MISS / DROPZONE STATES\n   - neon green for dropzone\n   - red glow for hit\n   - purple glow for miss\n   ========================================= */\n.player-board__cell--valid-dropzone {\n  background-color: var(--battleship-ship-valid-dropzone);\n  opacity: 0.9;\n  outline: 2px solid #39FF14;\n  outline-offset: -2px;\n  box-shadow: 0 0 16px var(--battleship-ship-valid-dropzone),\n    0 0 8px var(--battleship-ship-valid-dropzone),\n}\n\n.player-board__cell--invalid-dropzone {\n  background-color: var(--battleship-ship-invalid-dropzone);\n  opacity: 0.9;\n  outline: 2px solid var(--battleship-ship-invalid-dropzone);\n  outline-offset: -2px;\n  box-shadow:\n    0 0 16px var(--battleship-ship-invalid-dropzone),\n    0 0 8px var(--battleship-ship-invalid-dropzone);\n  background-image: repeating-linear-gradient(45deg,\n      transparent,\n      transparent 4px,\n      rgba(255, 255, 255, 0.2) 4px,\n      rgba(255, 255, 255, 0.2) 8px);\n}\n\n.player-board__cell--miss {\n  position: relative;\n  background-color: transparent;\n  border: none;\n  border-radius: 50%;\n}\n\n.player-board__cell--miss::after {\n  content: '';\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  width: 12px;\n  height: 12px;\n  background-color: var(--battleship-miss-color);\n  border-radius: 50%;\n  transform: translate(-50%, -50%);\n  box-shadow:\n    0 0 16px var(--battleship-miss-color),\n    0 0 8px var(--battleship-miss-color);\n}\n\n.player-board__cell--hit {\n  background-color: var(--battleship-hit-color);\n  border: none;\n  border-radius: 0.3rem;\n  box-shadow:\n    0 0 16px var(--battleship-hit-color),\n    0 0 8px var(--battleship-hit-color);\n}\n\n.site-footer {\n  color: var(--battleship-accent-color);\n  font-size: 1rem;\n  position: absolute;\n  height: 50px;\n  display: flex;\n  align-items: center;\n  padding: 1rem;\n  bottom: 0;\n}\n\n.site-footer__icon {\n  vertical-align: middle;\n  color: var(--battleship-accent-color);\n  transition: transform 0.2s ease-in-out;\n}\n\n.site-footer__icon:hover {\n  transform: scale(1.1);\n}\n\n.site-footer__icon:active {\n  transform: scale(1);\n}\n\n/* =========================================\n   MEDIA QUERIES\n   ========================================= */\n@media (min-width:320px) and (max-width:767px) {\n  .main-container {\n    gap: 1.5rem;\n  }\n\n  .main-container__message {\n    font-size: 1rem;\n    width: 15ch;\n  }\n\n  .main-container__game {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: center;\n    gap: 1.5rem;\n  }\n\n  .player-board {\n    grid-template-columns: repeat(10, 25px);\n    gap: 0.2rem;\n    padding: 0.2rem;\n  }\n\n  .player-board--attackable {\n    box-shadow: 0 0 6px var(--battleship-accent-color);\n    transform: scale(1.03);\n    padding: 0.5rem;\n  }\n\n  .player-board__cell {\n    width: 25px;\n    height: 25px;\n  }\n\n  .player-board__cell--ship,\n  .ship__segment {\n    width: 25px;\n    height: 25px;\n    box-shadow:\n      0 0 8px var(--battleship-ship-color),\n      0 0 4px var(--battleship-ship-color);\n  }\n\n  .ship--draggable {\n    gap: 0.2rem;\n  }\n\n  .dock-container__shipyard {\n    height: 25vh;\n    width: auto;\n    min-width: 185px;\n    gap: 0.7rem;\n    padding: 1.5rem;\n  }\n\n  .battleship__button {\n    padding: 0.2rem;\n    font-size: 0.7rem;\n    letter-spacing: 0.1rem;\n  }\n\n  .battleship__button--new-game {\n    margin-bottom: 3rem;\n  }\n\n  .player-board__cell--valid-dropzone {\n    box-shadow:\n      0 0 4px var(--battleship-ship-valid-dropzone),\n      0 0 2px var(--battleship-ship-valid-dropzone);\n  }\n\n  .player-board__cell--invalid-dropzone {\n    box-shadow:\n      0 0 4px var(--battleship-ship-invalid-dropzone),\n      0 0 2px var(--battleship-ship-invalid-dropzone);\n  }\n\n  .player-board__cell--hit {\n    box-shadow:\n      0 0 8px var(--battleship-hit-color),\n      0 0 4px var(--battleship-hit-color);\n  }\n\n  .player-board__cell--miss::after {\n    width: 6px;\n    height: 6px;\n    box-shadow:\n      0 0 8px var(--battleship-miss-color),\n      0 0 4px var(--battleship-miss-color);\n  }\n\n  .site-footer {\n    font-size: 0.5rem;\n  }\n\n  .site-footer__icon {\n    height: 14px;\n    width: 14px;\n  }\n}\n\n@media (min-width:375px) and (max-width: 767px) {\n  .main-container__message {\n    font-size: 1.2rem;\n    width: 20ch;\n  }\n}\n\n@media (min-width:768px) and (max-width: 1023px) {\n  .main-container {\n    gap: 2rem;\n  }\n\n  .main-container__message {\n    font-size: 1.5rem;\n  }\n\n  .main-container__game {\n    flex-direction: column;\n    gap: 1.5rem;\n  }\n\n  .player-board {\n    grid-template-columns: repeat(10, 27px);\n    gap: 0.3rem;\n  }\n\n  .player-board--attackable {\n    box-shadow: 0 0 12px var(--battleship-accent-color);\n    transform: scale(1.03);\n  }\n\n  .player-board__cell {\n    width: 27px;\n    height: 27px;\n  }\n\n  .player-board__cell--ship,\n  .ship__segment {\n    width: 27px;\n    height: 27px;\n  }\n\n  .ship--draggable {\n    gap: 0.3rem;\n  }\n\n  .dock-container__shipyard {\n    height: 27vh;\n    width: auto;\n    min-width: 220px;\n    gap: 0.7rem;\n  }\n\n  .battleship__button {\n    padding: 0.3rem;\n    font-size: 0.9rem;\n  }\n\n  .battleship__button--new-game {\n    margin-bottom: 5rem;\n  }\n\n  .player-board__cell--valid-dropzone {\n    box-shadow:\n      0 0 16px var(--battleship-ship-valid-dropzone),\n      0 0 8px var(--battleship-ship-valid-dropzone),\n  }\n\n  .player-board__cell--invalid-dropzone {\n    box-shadow:\n      0 0 16px var(--battleship-ship-invalid-dropzone),\n      0 0 8px var(--battleship-ship-invalid-dropzone);\n  }\n\n  .player-board__cell--miss::after {\n    width: 8px;\n    height: 8px;\n    box-shadow:\n      0 0 16px var(--battleship-miss-color),\n      0 0 8px var(--battleship-miss-color);\n  }\n\n  .player-board__cell--hit {\n    box-shadow:\n      0 0 16px var(--battleship-hit-color),\n      0 0 8px var(--battleship-hit-color);\n  }\n\n  .site-footer {\n    font-size: 0.7rem;\n  }\n\n  .site-footer__icon {\n    height: 16px;\n    width: 16px;\n  }\n}\n\n@media (min-width:1024px) {\n  .player-board {\n    grid-template-columns: repeat(10, 35px);\n    gap: 0.4rem;\n  }\n\n  .player-board__cell {\n    width: 35px;\n    height: 35px;\n  }\n\n  .player-board__cell--ship,\n  .ship__segment {\n    width: 35px;\n    height: 35px;\n  }\n\n  .ship--draggable {\n    gap: 0.4rem;\n  }\n\n  .dock-container__shipyard {\n    height: 37vh;\n    width: auto;\n    min-width: 265px;\n    gap: 1rem;\n  }\n}\n\n.main-container__mode-select {\n  display: flex;\n  flex-direction: column;\n  gap: 1rem;\n  position: absolute;\n}\n\n.battleship__button.battleship__button--1-player,\n.battleship__button.battleship__button--2-player {\n  font-size: 2rem;\n  padding: 1.5rem;\n  border-radius: 1rem;\n}\n",""]);const s=i},314:e=>{e.exports=function(e){var n=[];return n.toString=function(){return this.map(function(n){var t="",r=void 0!==n[5];return n[4]&&(t+="@supports (".concat(n[4],") {")),n[2]&&(t+="@media ".concat(n[2]," {")),r&&(t+="@layer".concat(n[5].length>0?" ".concat(n[5]):""," {")),t+=e(n),r&&(t+="}"),n[2]&&(t+="}"),n[4]&&(t+="}"),t}).join("")},n.i=function(e,t,r,a,o){"string"==typeof e&&(e=[[null,e,void 0]]);var i={};if(r)for(var s=0;s<this.length;s++){var l=this[s][0];null!=l&&(i[l]=!0)}for(var c=0;c<e.length;c++){var d=[].concat(e[c]);r&&i[d[0]]||(void 0!==o&&(void 0===d[5]||(d[1]="@layer".concat(d[5].length>0?" ".concat(d[5]):""," {").concat(d[1],"}")),d[5]=o),t&&(d[2]?(d[1]="@media ".concat(d[2]," {").concat(d[1],"}"),d[2]=t):d[2]=t),a&&(d[4]?(d[1]="@supports (".concat(d[4],") {").concat(d[1],"}"),d[4]=a):d[4]="".concat(a)),n.push(d))}},n}},540:e=>{e.exports=function(e){var n=document.createElement("style");return e.setAttributes(n,e.attributes),e.insert(n,e.options),n}},601:e=>{e.exports=function(e){return e[1]}},659:e=>{var n={};e.exports=function(e,t){var r=function(e){if(void 0===n[e]){var t=document.querySelector(e);if(window.HTMLIFrameElement&&t instanceof window.HTMLIFrameElement)try{t=t.contentDocument.head}catch(e){t=null}n[e]=t}return n[e]}(e);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(t)}},825:e=>{e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var n=e.insertStyleElement(e);return{update:function(t){!function(e,n,t){var r="";t.supports&&(r+="@supports (".concat(t.supports,") {")),t.media&&(r+="@media ".concat(t.media," {"));var a=void 0!==t.layer;a&&(r+="@layer".concat(t.layer.length>0?" ".concat(t.layer):""," {")),r+=t.css,a&&(r+="}"),t.media&&(r+="}"),t.supports&&(r+="}");var o=t.sourceMap;o&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),n.styleTagTransform(r,e,n.options)}(n,e,t)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(n)}}}}},n={};function t(r){var a=n[r];if(void 0!==a)return a.exports;var o=n[r]={id:r,exports:{}};return e[r](o,o.exports,t),o.exports}t.n=e=>{var n=e&&e.__esModule?()=>e.default:()=>e;return t.d(n,{a:n}),n},t.d=(e,n)=>{for(var r in n)t.o(n,r)&&!t.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:n[r]})},t.o=(e,n)=>Object.prototype.hasOwnProperty.call(e,n),t.nc=void 0;var r=t(72),a=t.n(r),o=t(825),i=t.n(o),s=t(659),l=t.n(s),c=t(56),d=t.n(c),p=t(540),h=t.n(p),u=t(113),m=t.n(u),b=t(208),g={};g.styleTagTransform=m(),g.setAttributes=d(),g.insert=l().bind(null,"head"),g.domAPI=i(),g.insertStyleElement=h();a()(b.A,g);b.A&&b.A.locals&&b.A.locals;const v=document.querySelector('[data-player="1"]'),f=document.querySelector('[data-player="2"]'),y=document.querySelector(".main-container"),_={player1ClickHandler:null,player2ClickHandler:null,shipRotationHandler:null,shipPlacementHandler:null},x=(e,n,t=!0)=>{const{successfulHits:r,missedShots:a}=e.gameboard,o=e.gameboard.getGrid();n.innerHTML="";for(let e=0;e<o.length;e++)for(let i=0;i<o[e].length;i++){const s=document.createElement("div");s.classList.add("player-board__cell"),s.dataset.row=e,s.dataset.column=i;const l=o[e][i],c=`${e},${i}`;r.has(c)&&s.classList.add("player-board__cell--hit","smoke"),a.has(c)&&s.classList.add("player-board__cell--miss"),l&&t&&(s.classList.add("player-board__cell--ship"),s.dataset.shipId=l.id),n.appendChild(s)}},w=(e,n,t,r,a,o,i="1Player")=>{const s=document.querySelector(".main-container__game"),l=document.createElement("div");l.classList.add("dock-container");const c=S(e,a,o),d=document.createElement("div");d.classList.add("dock-container__actions"),d.append(E(n),L(t),T(i,r)),l.append(c,d),s.append(l)},S=(e,n,t)=>{const r=document.createElement("div");r.classList.add("dock-container__shipyard");const a={isDragging:!1,beingDragged:null,startX:0,startY:0,segmentIndex:0,boardElement:t};Object.values(e).forEach(e=>{const n=document.createElement("div");n.classList.add("ship","ship--draggable"),n.dataset.type=e.type,n.dataset.orientation="horizontal";for(let t=0;t<e.length;t++){const e=document.createElement("div");e.classList.add("ship__segment"),n.appendChild(e)}const t=(e,t,r)=>{a.isDragging=!0,a.beingDragged=n,a.startX=e,a.startY=t,a.segmentIndex=r,n.style.cursor="grabbing",n.classList.add("ship--dragging")},s=(t,r)=>{const a=n.getBoundingClientRect();return"horizontal"===r?Math.floor((t.clientX-a.left)/(a.width/e.length)):Math.floor((t.clientY-a.top)/(a.height/e.length))};n.addEventListener("mousedown",e=>{e.preventDefault();const r=s(e,n.dataset.orientation);t(e.clientX,e.clientY,r),document.addEventListener("mousemove",o),document.addEventListener("mouseup",i)}),n.addEventListener("touchstart",e=>{e.preventDefault();const r=e.touches[0],a=s(r,n.dataset.orientation);t(r.clientX,r.clientY,a),document.addEventListener("touchmove",o,{passive:!1}),document.addEventListener("touchend",i,{passive:!1})}),r.appendChild(n)});const o=t=>{if(!a.isDragging)return;const r=t.clientX??t.touches[0].clientX,o=t.clientY??t.touches[0].clientY;a.beingDragged.style.transform=`translate(${r-a.startX}px, ${o-a.startY}px)`;const i=a.beingDragged.style.visibility;a.beingDragged.style.visibility="hidden";const s=document.elementFromPoint(r,o);if(a.beingDragged.style.visibility=i,!s||!s.classList.contains("player-board__cell"))return void a.boardElement.querySelectorAll(".player-board__cell--valid-dropzone, .player-board__cell--invalid-dropzone").forEach(e=>e.classList.remove("player-board__cell--valid-dropzone","player-board__cell--invalid-dropzone"));let l=parseInt(s.dataset.row,10),c=parseInt(s.dataset.column,10);const d=a.beingDragged.dataset.orientation,p=e[a.beingDragged.dataset.type].length;"horizontal"===d?c-=a.segmentIndex:l-=a.segmentIndex,z(a.boardElement,l,c,p,d,n)},i=t=>{const r=a.boardElement;if(r.querySelectorAll(".player-board__cell--valid-dropzone, .player-board__cell--invalid-dropzone").forEach(e=>e.classList.remove("player-board__cell--valid-dropzone","player-board__cell--invalid-dropzone")),!a.isDragging)return;const s=t.clientX??t.changedTouches[0].clientX,l=t.clientY??t.changedTouches[0].clientY,c=a.beingDragged;a.isDragging=!1,a.beingDragged=null,c.classList.remove("ship--dragging");const d=c.style.visibility;c.style.visibility="hidden";const p=document.elementFromPoint(s,l);c.style.visibility=d;const h=c.dataset.type,u=e[h];if(!u||u.isPlaced)return;let m=!1;if(p&&p.classList.contains("player-board__cell")){let e=parseInt(p.dataset.row,10),t=parseInt(p.dataset.column,10);const o=c.dataset.orientation;"horizontal"===o?t-=a.segmentIndex:e-=a.segmentIndex;try{n.gameboard.placeShip(e,t,u,o),u.isPlaced=!0,c.remove(),x(n,r),m=!0}catch(e){c.style.transform="",c.style.visibility="",P(e.message)}}m||(c.style.transform="",c.style.visibility=""),document.removeEventListener("mousemove",o),document.removeEventListener("mouseup",i),document.removeEventListener("touchmove",o),document.removeEventListener("touchend",i)};return r},z=(e,n,t,r,a,o)=>{e.querySelectorAll(".player-board__cell--valid-dropzone, .player-board__cell--invalid-dropzone").forEach(e=>e.classList.remove("player-board__cell--valid-dropzone","player-board__cell--invalid-dropzone"));for(let i=0;i<r;i++){let r=n,s=t;"horizontal"===a?s+=i:r+=i;const l=e.querySelector(`.player-board__cell[data-row="${r}"][data-column="${s}"]`);if(!l)continue;let c=!0;for(let e=-1;e<=1;e++)for(let n=-1;n<=1;n++){const t=r+e,a=s+n;if(t<0||t>=o.gameboard.boardSize||a<0||a>=o.gameboard.boardSize)continue;o.gameboard.board[t][a]&&(c=!1)}c?(l.classList.add("player-board__cell--valid-dropzone"),l.classList.remove("player-board__cell--invalid-dropzone")):(l.classList.add("player-board__cell--invalid-dropzone"),l.classList.remove("player-board__cell--valid-dropzone"))}},k=(e,n,t)=>{const r=document.createElement("button");return r.textContent=e,r.classList.add("battleship__button",`battleship__button--${n}`),r.addEventListener("click",t),r},E=e=>k("Randomize","randomize",e),L=e=>k("Reset","reset",e),T=(e,n)=>k("1-Player"===e?"Start":"Confirm","start-game",n),P=(e="Drag and place your ships.")=>{const n=document.querySelector(".main-container__message"),t=document.createElement("p");n.innerHTML="",t.textContent=e,n.appendChild(t)},C=(e,n)=>{e.classList.toggle("player-board--attackable",n),e.classList.toggle("player-board--protected",!n)},H=()=>{v.classList.remove("player-board--attackable","player-board--protected"),f.classList.remove("player-board--attackable","player-board--protected")},I=(e,n,t,r,a)=>{const o=e===n?t:n,i=o===t;C(r,o===n),C(a,i)},$=()=>{const e=document.querySelector(".dock-container");e&&e.remove()},A=e=>{if(e){const n=document.querySelector(`.ship--draggable[data-type="${e}"]`);n&&n.remove()}else{document.querySelectorAll(".ship--draggable").forEach(e=>e.remove())}},M=(e,n,t)=>r=>{const a=r.target;if(!a.classList.contains("player-board__cell--ship"))return;const o=a.dataset.shipId;t(e.gameboard,o)&&x(e,n)},D=e=>{_.shipRotationHandler&&(e.removeEventListener("click",_.shipRotationHandler),_.shipRotationHandler=null)},O=(e,n)=>{_.shipPlacementHandler&&n.removeEventListener("place-ship",_.shipPlacementHandler),_.shipPlacementHandler=((e,n)=>t=>{const{shipType:r,startRow:a,startColumn:o,orientation:i}=t.detail;try{const t=e.gameboard.fleet[r];e.gameboard.placeShip(a,o,t,i),A(r),x(e,n)}catch(e){P(e.message)}})(e,n),n.addEventListener("place-ship",_.shipPlacementHandler)},R=e=>{_.shipPlacementHandler&&(e.removeEventListener("place-ship",_.shipPlacementHandler),_.shipPlacementHandler=null)},B=e=>{e&&(e.style.display="grid")},Y=e=>{e&&(e.style.display="none")};const F=class{constructor(e=10){this.boardSize=e,this.board=this.initializeBoard(),this.missedShots=new Set,this.successfulHits=new Set,this.shipPositions=new Set,this.fleet={}}initializeBoard(){return Array.from({length:this.boardSize},()=>Array(this.boardSize).fill(null))}placeShip(e,n,t,r="horizontal"){if(e<0||e>=this.boardSize||n<0||n>=this.boardSize)throw new Error("Invalid starting coordinates: Position is outside the board.");if("horizontal"===r&&n+t.length>this.boardSize||"vertical"===r&&e+t.length>this.boardSize)throw new Error("Ship placement exceeds board boundaries.");t.id=t.type,t.orientation=r,t.x=e,t.y=n;const a=new Set;for(let o=0;o<t.length;o++)for(let t=-1;t<=1;t++)for(let i=-1;i<=1;i++){const s="horizontal"===r?e+t:e+o+t,l="horizontal"===r?n+o+i:n+i;s>=0&&s<this.boardSize&&l>=0&&l<this.boardSize&&a.add(`${s},${l}`)}for(const e of a){const[n,r]=e.split(",").map(Number),a=this.board[n][r];if(a&&a.id!==t.id)throw new Error("Invalid placement: Overlapping or adjacent to another ship.")}for(let a=0;a<t.length;a++){const o="vertical"===r?e+a:e,i="horizontal"===r?n+a:n;this.board[o][i]=t,this.shipPositions.add(`${o},${i}`)}this.fleet[t.type]=t}receiveAttack(e,n){const t=`${e},${n}`;if(this.successfulHits.has(t)||this.missedShots.has(t))throw new Error("This cell has already been attacked.");const r=this.board[e][n];return r?(r.hit(),this.successfulHits.add(t),this.markDiagonalBuffer(e,n),r.isSunk&&this.markFullShipBuffer(r),"hit"):(this.missedShots.add(t),"miss")}markDiagonalBuffer(e,n){const t=[[-1,-1],[-1,1],[1,-1],[1,1]];for(const[r,a]of t){const t=e+r,o=n+a,i=`${t},${o}`,s=t>=0&&t<this.boardSize&&o>=0&&o<this.boardSize,l=!this.shipPositions.has(i)&&!this.successfulHits.has(i)&&!this.missedShots.has(i);s&&l&&this.missedShots.add(i)}}markFullShipBuffer(e){for(let n=-1;n<=e.length;n++)for(let t=-1;t<=1;t++){let r=e.x,a=e.y;"horizontal"===e.orientation?(r+=t,a+=n):(r+=n,a+=t);const o=`${r},${a}`,i=r>=0&&r<this.boardSize&&a>=0&&a<this.boardSize,s=!this.shipPositions.has(o);i&&s&&this.missedShots.add(o)}}get allShipsSunk(){const e=Object.values(this.fleet);if(0===e.length)throw new Error("No ships have been placed on the board.");return e.every(e=>e.isSunk)}getGrid(){return this.board}reset(){this.board=this.initializeBoard(),this.successfulHits.clear(),this.missedShots.clear(),this.shipPositions.clear(),this.fleet={}}};const N=class{constructor(e,n="You",t=!1){this.name=n,this.isComputer=t,this.gameboard=new F,this.id=e}};const q=class{constructor(e,n){this.type=e,this.length=n,this.hits=0}hit(){this.hits++}get isSunk(){return this.hits>=this.length}};let G,j,X,Q,U;const V={hunting:!1,targetQueue:[],aiTimeoutId:null,attackDelayRange:{hunting:[500,900],searching:[1200,2500]}},J=()=>{K(),V.hunting=!1,V.targetQueue=[]},K=()=>{null!==V.aiTimeoutId&&(clearTimeout(V.aiTimeoutId),V.aiTimeoutId=null)},Z=()=>{const[e,n]=V.hunting?V.attackDelayRange.hunting:V.attackDelayRange.searching;return Math.floor(Math.random()*(n-e+1)+e)},W=()=>{if(G.gameHasEnded)return;let e=0;for(;V.hunting&&V.targetQueue.length>0;){const e=V.targetQueue.shift(),[n,t]=e;if(!(!X.gameboard.successfulHits.has(`${n},${t}`)&&!X.gameboard.missedShots.has(`${n},${t}`)))continue;const{success:r,allShipsSunk:a,errorMessage:o,result:i}=Te(j,X,n,t);if(o)return void P(o);if(r)return ee(i,n,t),x(X,Q),a?(G.winner=j.id,void U()):void Ee()}const n=te();for(;e<100;){let t=Math.floor(10*Math.random()),r=Math.floor(10*Math.random());const a=`${t},${r}`;if(!(!X.gameboard.successfulHits.has(a)&&!X.gameboard.missedShots.has(a))||!re(t,r,n)){e++;continue}const{success:o,allShipsSunk:i,errorMessage:s,result:l}=Te(j,X,t,r);if(s)return void P(s);if(o)return ee(l,t,r),x(X,Q),i?(G.winner=j.id,void U()):void Ee()}},ee=(e,n,t)=>{if("hit"!==e)return;V.hunting=!0;const r=X.gameboard.getGrid()[n][t],a=ne(n,t);V.targetQueue.push(...a),r?.isSunk&&J()},ne=(e,n)=>[[e,n-1],[e,n+1],[e-1,n],[e+1,n]].filter(([e,n])=>e>=0&&e<10&&n>=0&&n<10&&!X.gameboard.successfulHits.has(`${e},${n}`)&&!X.gameboard.missedShots.has(`${e},${n}`)),te=()=>Object.values(X.gameboard.fleet).filter(e=>!e.isSunk).map(e=>e.length),re=(e,n,t)=>{for(const r of t){let t=!0,a=!0;for(let o=0;o<r;o++)(n+r>10||X.gameboard.successfulHits.has(`${e},${n+o}`)||X.gameboard.missedShots.has(`${e},${n+o}`))&&(t=!1),(e+r>10||X.gameboard.successfulHits.has(`${e+o},${n}`)||X.gameboard.missedShots.has(`${e+o},${n}`))&&(a=!1);if(t||a)return!0}return!1},ae=new N("player1");let oe,ie;const se=[{type:"carrier",length:5},{type:"battleship",length:4},{type:"destroyer",length:3},{type:"submarine",length:2},{type:"patrolBoat",length:1}],le={currentTurn:null,isFirstTurn:!0,isGameOver:!1,winner:null},ce="You go first! Launch your attack!",de="Enemy has the initiative. Stay sharp.",pe="Opponent's turn.",he="You’ve sunk the enemy fleet. Victory is yours!",ue="All your ships have been destroyed. Defeat!",me="Please place all your ships before starting the game.",be=(e,n=se)=>{const t={};return n.forEach(({type:e,length:n})=>{t[e]=new q(e,n)}),e.gameboard.fleet=t,t},ge=e=>{ve({player:ie,playerBoardElement:ie===ae?v:f,onRandomize:()=>_e(ie),onReset:()=>xe(ie,()=>ge(e)),onStart:()=>{e||ie!==ae?we():(ie=oe,ge(e))},mode:e?"1-Player":"2-Player",hideOtherBoard:ie===ae?f:v})},ve=({player:e,playerBoardElement:n,onRandomize:t,onReset:r,onStart:a,mode:o,hideOtherBoard:i})=>{i&&Y(i),B(n),$();const s=be(e);x(e,n),w(s,t,r,a,e,n,o),O(e,n),((e,n,t)=>{_.shipRotationHandler&&n.removeEventListener("click",_.shipRotationHandler),_.shipRotationHandler=M(e,n,t),n.addEventListener("click",_.shipRotationHandler)})(e,n,fe),ie.isComputer?P():P(ie===ae?"Player 1: Place your ships and confirm when ready.":"Player 2: Place your ships and confirm when ready.")},fe=(e,n)=>{const t=e.board,r=[...e.shipPositions].map(e=>e.split(",").map(Number)).filter(([e,r])=>t[e][r]?.id===n);if(0===r.length)return!1;const[a,o]=r[0],i=t[a][o],s=i.orientation,l=i.length,c=t.map(e=>[...e]),d=new Set(e.shipPositions),p=r[0][0]===r[1][0],h=r.sort((e,n)=>p?e[1]-n[1]:e[0]-n[0]),u=Math.floor(l/2),[m,b]=h[u],g=p?"vertical":"horizontal";let v=m,f=b;"horizontal"===g?f=b-u:v=m-u;for(const[n,r]of h)t[n][r]=null,e.shipPositions.delete(`${n},${r}`);try{return e.placeShip(v,f,i,g),!0}catch(n){return e.board=c,e.shipPositions=d,i.orientation=s,P(n.message),!1}},ye=(e,n,t=()=>{})=>{e.gameboard.reset();const r=be(e);for(const n in r){const t=r[n];let a=!1,o=0;for(;!a&&o<100;){const n=Math.floor(10*Math.random()),r=Math.floor(10*Math.random()),i=Math.random()<.5?"horizontal":"vertical";try{e.gameboard.placeShip(n,r,t,i),a=!0}catch{o++}}}t(),x(e,n)},_e=e=>{ye(e,e===ae?v:f,A)},xe=(e,n)=>{const t=e===ae?v:f;e.gameboard.reset(),$(),x(e,t);const r=be(e);w(r,()=>_e(e,t),()=>xe(e,n),n,e,t),le.isFirstTurn=!0},we=()=>{(B(v),(()=>{const e=document.querySelector(".dock-container__shipyard");return!!e&&0===e.querySelectorAll(".ship--draggable").length})())?(R(v),D(v),R(f),D(f),$(),ze(),oe.isComputer?(x(ae,v),Le(),j=oe,G=le,X=ae,Q=v,U=Ce,P(le.currentTurn===ae.id?ce:de)):(x(ae,v,!1),x(oe,f,!1),I(ae,ae,oe,v,f),I(oe,ae,oe,v,f),P(le.currentTurn===ae.id?"Player 1: You go first.":"Player 2: You go first.")),Se(),Ee(),y.appendChild(k("New Game","new-game",ke))):P(me)},Se=()=>{_.player1ClickHandler&&f.removeEventListener("click",_.player1ClickHandler),_.player2ClickHandler&&v.removeEventListener("click",_.player2ClickHandler),_.player1ClickHandler=Pe(ae,oe,f),_.player2ClickHandler=Pe(oe,ae,v),f.addEventListener("click",_.player1ClickHandler),oe.isComputer||v.addEventListener("click",_.player2ClickHandler)},ze=()=>{le.currentTurn=Math.random()<.5?ae.id:oe.id},ke=()=>{le.currentTurn=null,le.isFirstTurn=!0,le.isGameOver=!1,J(),Y(f),H(),ae.gameboard.reset(),oe.gameboard.reset(),(()=>{const e=document.querySelector(".battleship__button--new-game");e&&e.remove()})()},Ee=()=>{le.isFirstTurn||(le.currentTurn=le.currentTurn===ae.id?oe.id:ae.id);const e=le.currentTurn===ae.id?ae:oe;I(e,ae,oe,v,f),e.isComputer?(le.isFirstTurn||P(pe),(e=>{K();const n=Z();V.aiTimeoutId=setTimeout(e,n)})(W)):le.isFirstTurn||P(le.currentTurn===ae.id?"Player 1: It's your turn.":"Player 2: It's your turn."),le.isFirstTurn=!1},Le=()=>{ye(oe,f),x(oe,f,!1),B(f)},Te=(e,n,t,r)=>{if(le.isGameOver||e.id!==le.currentTurn)return{success:!1,allShipsSunk:!1,errorMessage:null};try{const e=n.gameboard.receiveAttack(t,r);return{success:!0,allShipsSunk:n.gameboard.allShipsSunk,errorMessage:null,result:e}}catch(e){return{success:!1,allShipsSunk:!1,errorMessage:e.message}}},Pe=(e,n,t)=>r=>{const a=r.target;if(!a.classList.contains("player-board__cell"))return;const o=parseInt(a.dataset.row),i=parseInt(a.dataset.column),{success:s,allShipsSunk:l,errorMessage:c}=Te(e,n,o,i);if(c)P(c);else if(s){if(x(n,t,!1),l)return le.winner=e.id,void Ce();Ee()}},Ce=()=>{le.isGameOver||(le.isGameOver=!0,K(),oe.isComputer?P("player1"===le.winner?he:ue):P(le.currentTurn===ae.id?"Onalaps si Player 1!":"Onalaps si Player 2!"),H(),f.style.pointerEvents="none",x(oe,f))};(e=>{const n=document.createElement("div");n.classList.add("main-container__mode-select"),["1-Player","2-Player"].forEach(t=>{const r=k(t,`${t.toLowerCase()}`,()=>{n.remove(),e("1-Player"===t)});n.appendChild(r)}),y.append(n)})(e=>{document.querySelector(".main-container__game").classList.add(e?"one-player-mode":"two-player-mode"),oe=e?new N("player2","Computer",!0):new N("player2"),ie=ae,Y(f),ge(e)}),(()=>{const e=(new Date).getFullYear(),n=document.createElement("footer");n.classList.add("site-footer"),n.innerHTML=`\n    <p class="site-footer__text">\n      © ${e} Designed and built by ej\n      <a href="https://github.com/krig6" target="_blank" aria-label="GitHub" rel="noopener noreferrer">\n        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 16 16"\n          class="site-footer__icon">\n          <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 \n            2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 \n            0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52\n            -.01-.53.63-.01 1.08.58 1.23.82.72 1.21 \n            1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2\n            -3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15\n            -.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82a7.66 \n            7.66 0 0 1 2-.27c.68 0 1.36.09 2 .27 1.53-1.04 \n            2.2-.82 2.2-.82.44 1.1.16 1.92.08 \n            2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 \n            3.75-3.65 3.95.29.25.54.73.54 1.48 \n            0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 \n            8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z" />\n        </svg>\n      </a>\n    </p>\n      `,document.body.append(n)})()})();