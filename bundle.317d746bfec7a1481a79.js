(()=>{"use strict";var e={56:(e,t,n)=>{e.exports=function(e){var t=n.nc;t&&e.setAttribute("nonce",t)}},72:e=>{var t=[];function n(e){for(var n=-1,r=0;r<t.length;r++)if(t[r].identifier===e){n=r;break}return n}function r(e,r){for(var o={},s=[],i=0;i<e.length;i++){var l=e[i],c=r.base?l[0]+r.base:l[0],d=o[c]||0,p="".concat(c," ").concat(d);o[c]=d+1;var h=n(p),u={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==h)t[h].references++,t[h].updater(u);else{var m=a(u,r);r.byIndex=i,t.splice(i,0,{identifier:p,updater:m,references:1})}s.push(p)}return s}function a(e,t){var n=t.domAPI(t);n.update(e);return function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;n.update(e=t)}else n.remove()}}e.exports=function(e,a){var o=r(e=e||[],a=a||{});return function(e){e=e||[];for(var s=0;s<o.length;s++){var i=n(o[s]);t[i].references--}for(var l=r(e,a),c=0;c<o.length;c++){var d=n(o[c]);0===t[d].references&&(t[d].updater(),t.splice(d,1))}o=l}}},113:e=>{e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},208:(e,t,n)=>{n.d(t,{A:()=>i});var r=n(601),a=n.n(r),o=n(314),s=n.n(o)()(a());s.push([e.id,'/* =========================================\n   GLOBAL RESET\n   ========================================= */\n*,\n*::before,\n*::after {\n  border: none;\n  box-sizing: border-box;\n  margin: 0;\n  padding: 0;\n}\n\n/* =========================================\n   GLOBAL COLOR VARIABLES\n   ========================================= */\n:root {\n  --battleship-body-bg-color: #0D1B1E;\n  --battleship-accent-color: #88B8E6;\n  --battleship-ship-color: #71ACD1;\n  --battleship-cell-color: #75A9E1;\n  --battleship-hit-color: #E53935;\n  --battleship-miss-color: #CBB2F0;\n}\n\n/* =========================================\n   BASE PAGE & BODY STYLING\n   ========================================= */\nhtml,\nbody {\n  font-family: "Orbitron", sans-serif;\n  font-optical-sizing: auto;\n  font-weight: 900;\n}\n\nbody {\n  display: flex;\n  justify-content: center;\n  width: auto;\n  height: 100vh;\n  background-color: var(--battleship-body-bg-color);\n}\n\n/* =========================================\n   MAIN CONTAINER LAYOUT\n   ========================================= */\n.main-container {\n  position: fixed;\n  top: 10%;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n  gap: 4rem;\n}\n\n.main-container__message {\n  color: var(--battleship-accent-color);\n  font-size: 2.5rem;\n  text-align: center;\n  text-shadow:\n    0 0 0px var(--battleship-accent-color),\n    0 0 1px var(--battleship-accent-color),\n    0 0 4px var(--battleship-accent-color);\n}\n\n.main-container__game {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  gap: 5rem;\n}\n\n/* =========================================\n   PLAYER BOARD STYLING\n   ========================================= */\n.player-board {\n  display: grid;\n  grid-template-columns: repeat(10, 40px);\n  gap: 0.5rem;\n  padding: 0.5rem;\n  position: relative;\n  background-color: var(--battleship-body-bg-color);\n  border-radius: 1rem;\n  transition: transform 0.2s ease, opacity 0.2s ease, filter 0.2s ease;\n}\n\n.player-board[data-player="2"] {\n  display: none;\n}\n\n.player-board--attackable {\n  transform: scale(1.02);\n  box-shadow: 0 0 24px var(--battleship-accent-color);\n  opacity: 1;\n  filter: none;\n}\n\n.player-board--protected {\n  opacity: 0.5;\n  filter: grayscale(50%);\n  pointer-events: none;\n}\n\n/* =========================================\n   PLAYER BOARD CELLS\n   ========================================= */\n.player-board__cell {\n  position: relative;\n  z-index: 0;\n  width: 40px;\n  height: 40px;\n  background-color: transparent;\n  border: 2px solid var(--battleship-cell-color);\n  border-radius: 0.3rem;\n}\n\n.player-board[data-player="2"] .player-board__cell:not(.player-board__cell--hit):not(.player-board__cell--miss):hover {\n  background-color: var(--battleship-accent-color);\n  border: none;\n  box-shadow:\n    0 0 4px var(--battleship-accent-color),\n    0 0 8px var(--battleship-accent-color);\n  outline: 1px solid var(--battleship-accent-color);\n  cursor: crosshair;\n  transition: all 0.2s ease-in-out;\n}\n\n/* =========================================\n   SHIP SEGMENTS\n   ========================================= */\n.player-board__cell--ship,\n.ship__segment {\n  width: 40px;\n  height: 40px;\n  background-color: var(--battleship-ship-color);\n  border-radius: 0.3rem;\n  box-shadow:\n    0 0 10px var(--battleship-ship-color),\n    0 0 5px var(--battleship-ship-color);\n}\n\n.ship--draggable {\n  display: flex;\n  gap: 0.5rem;\n  width: fit-content;\n  cursor: grab;\n}\n\n.ship--dragging {\n  opacity: 0.6;\n  cursor: grabbing;\n}\n\n/* =========================================\n   DOCK CONTAINER\n   ========================================= */\n.dock-container {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  gap: 1rem;\n}\n\n.dock-container__shipyard {\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  padding: 2rem;\n  height: 328px;\n  width: 296px;\n  gap: 1rem;\n  background-color: transparent;\n  border-radius: 0.3rem;\n  box-shadow: 0 0 5px var(--battleship-accent-color);\n}\n\n.dock-container__actions {\n  display: flex;\n  align-self: center;\n  gap: 1rem;\n}\n\n.dock-controls__actions {\n  align-self: center;\n}\n\n/* =========================================\n   BUTTON STYLING\n   ========================================= */\n.battleship__button {\n  padding: 0.4rem 0.8rem;\n  font-size: 0.9rem;\n  font-weight: 900;\n  text-transform: uppercase;\n  letter-spacing: 0.5px;\n  border-radius: 0.3rem;\n  border: 1.5px solid var(--battleship-accent-color);\n  cursor: pointer;\n  transition: all 0.15s ease-in-out;\n  color: var(--battleship-body-bg-color);\n  background-color: var(--battleship-accent-color);\n  box-shadow:\n    0 0 4px var(--battleship-accent-color),\n    0 0 8px var(--battleship-accent-color);\n}\n\n.battleship__button:hover {\n  background-color: var(--battleship-body-bg-color);\n  color: var(--battleship-accent-color);\n  box-shadow:\n    0 0 6px var(--battleship-accent-color),\n    0 0 12px var(--battleship-accent-color);\n  transform: scale(1.03);\n}\n\n.battleship__button--new-game:hover {\n  transform: translateX(-50%) scale(1.03);\n}\n\n.battleship__button:active {\n  box-shadow: 0 0 3px var(--battleship-accent-color);\n  transform: scale(0.97);\n}\n\n.battleship__button--new-game:active {\n  transform: translateX(-50%) scale(0.97);\n}\n\n.battleship__button--new-game {\n  position: absolute;\n  bottom: -15%;\n  left: 50%;\n  transform: translateX(-50%);\n}\n\n/* =========================================\n   HIT / MISS STATES\n   ========================================= */\n.player-board__cell--miss {\n  position: relative;\n  background-color: transparent;\n  border: none;\n  border-radius: 50%;\n}\n\n.player-board__cell--miss::after {\n  content: \'\';\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  width: 12px;\n  height: 12px;\n  background-color: var(--battleship-miss-color);\n  border-radius: 50%;\n  transform: translate(-50%, -50%);\n  box-shadow:\n    0 0 5px var(--battleship-miss-color),\n    0 0 10px var(--battleship-miss-color),\n    0 0 20px var(--battleship-miss-color);\n}\n\n.player-board__cell--hit {\n  background-color: var(--battleship-hit-color);\n  border: none;\n  border-radius: 0.3rem;\n  box-shadow:\n    0 0 8px var(--battleship-hit-color),\n    0 0 16px var(--battleship-hit-color),\n    0 0 32px var(--battleship-hit-color);\n}\n\n.site-footer {\n  color: var(--battleship-accent-color);\n  font-size: 1rem;\n  position: fixed;\n  bottom: 3%;\n  left: 50%;\n  transform: translateX(-50%);\n}\n\n.site-footer__icon {\n  vertical-align: middle;\n  color: var(--battleship-accent-color);\n  transition: transform 0.2s ease-in-out;\n}\n\n.site-footer__icon:hover {\n  transform: scale(1.1);\n}\n\n.site-footer__icon:active {\n  transform: scale(1);\n}\n',""]);const i=s},314:e=>{e.exports=function(e){var t=[];return t.toString=function(){return this.map(function(t){var n="",r=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),r&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),r&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n}).join("")},t.i=function(e,n,r,a,o){"string"==typeof e&&(e=[[null,e,void 0]]);var s={};if(r)for(var i=0;i<this.length;i++){var l=this[i][0];null!=l&&(s[l]=!0)}for(var c=0;c<e.length;c++){var d=[].concat(e[c]);r&&s[d[0]]||(void 0!==o&&(void 0===d[5]||(d[1]="@layer".concat(d[5].length>0?" ".concat(d[5]):""," {").concat(d[1],"}")),d[5]=o),n&&(d[2]?(d[1]="@media ".concat(d[2]," {").concat(d[1],"}"),d[2]=n):d[2]=n),a&&(d[4]?(d[1]="@supports (".concat(d[4],") {").concat(d[1],"}"),d[4]=a):d[4]="".concat(a)),t.push(d))}},t}},540:e=>{e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},601:e=>{e.exports=function(e){return e[1]}},659:e=>{var t={};e.exports=function(e,n){var r=function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}(e);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(n)}},825:e=>{e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(n){!function(e,t,n){var r="";n.supports&&(r+="@supports (".concat(n.supports,") {")),n.media&&(r+="@media ".concat(n.media," {"));var a=void 0!==n.layer;a&&(r+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),r+=n.css,a&&(r+="}"),n.media&&(r+="}"),n.supports&&(r+="}");var o=n.sourceMap;o&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),t.styleTagTransform(r,e,t.options)}(t,e,n)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}}},t={};function n(r){var a=t[r];if(void 0!==a)return a.exports;var o=t[r]={id:r,exports:{}};return e[r](o,o.exports,n),o.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.nc=void 0;var r=n(72),a=n.n(r),o=n(825),s=n.n(o),i=n(659),l=n.n(i),c=n(56),d=n.n(c),p=n(540),h=n.n(p),u=n(113),m=n.n(u),b=n(208),f={};f.styleTagTransform=m(),f.setAttributes=d(),f.insert=l().bind(null,"head"),f.domAPI=s(),f.insertStyleElement=h();a()(b.A,f);b.A&&b.A.locals&&b.A.locals;const g=class{constructor(e=10){this.boardSize=e,this.board=this.initializeBoard(),this.missedShots=new Set,this.successfulHits=new Set,this.shipPositions=new Set,this.fleet={}}initializeBoard(){return Array.from({length:this.boardSize},()=>Array(this.boardSize).fill(null))}placeShip(e,t,n,r="horizontal"){if(e<0||e>=this.boardSize||t<0||t>=this.boardSize)throw new Error("Invalid starting coordinates: Position is outside the board.");if("horizontal"===r&&t+n.length>this.boardSize||"vertical"===r&&e+n.length>this.boardSize)throw new Error("Ship placement exceeds board boundaries.");n.id=n.type,n.orientation=r,n.x=e,n.y=t;const a=new Set;for(let o=0;o<n.length;o++)for(let n=-1;n<=1;n++)for(let s=-1;s<=1;s++){const i="horizontal"===r?e+n:e+o+n,l="horizontal"===r?t+o+s:t+s;i>=0&&i<this.boardSize&&l>=0&&l<this.boardSize&&a.add(`${i},${l}`)}for(const e of a){const[t,r]=e.split(",").map(Number),a=this.board[t][r];if(a&&a.id!==n.id)throw new Error("Invalid placement: Overlapping or adjacent to another ship.")}for(let a=0;a<n.length;a++){const o="vertical"===r?e+a:e,s="horizontal"===r?t+a:t;this.board[o][s]=n,this.shipPositions.add(`${o},${s}`)}this.fleet[n.type]=n}receiveAttack(e,t){const n=`${e},${t}`;if(this.successfulHits.has(n)||this.missedShots.has(n))throw new Error("This cell has already been attacked.");const r=this.board[e][t];return r?(r.hit(),this.successfulHits.add(n),this.markDiagonalBuffer(e,t),r.isSunk&&this.markFullShipBuffer(r),"hit"):(this.missedShots.add(n),"miss")}markDiagonalBuffer(e,t){const n=[[-1,-1],[-1,1],[1,-1],[1,1]];for(const[r,a]of n){const n=e+r,o=t+a,s=`${n},${o}`,i=n>=0&&n<this.boardSize&&o>=0&&o<this.boardSize,l=!this.shipPositions.has(s)&&!this.successfulHits.has(s)&&!this.missedShots.has(s);i&&l&&this.missedShots.add(s)}}markFullShipBuffer(e){for(let t=-1;t<=e.length;t++)for(let n=-1;n<=1;n++){let r=e.x,a=e.y;"horizontal"===e.orientation?(r+=n,a+=t):(r+=t,a+=n);const o=`${r},${a}`,s=r>=0&&r<this.boardSize&&a>=0&&a<this.boardSize,i=!this.shipPositions.has(o);s&&i&&this.missedShots.add(o)}}get allShipsSunk(){const e=Object.values(this.fleet);if(0===e.length)throw new Error("No ships have been placed on the board.");return e.every(e=>e.isSunk)}getGrid(){return this.board}reset(){this.board=this.initializeBoard(),this.successfulHits.clear(),this.missedShots.clear(),this.shipPositions.clear(),this.fleet={}}};const v=class{constructor(e,t="You",n=!1){this.name=t,this.isComputer=n,this.gameboard=new g,this.id=e}};const y=class{constructor(e,t){this.type=e,this.length=t,this.hits=0}hit(){this.hits++}get isSunk(){return this.hits>=this.length}},S=document.querySelector('[data-player="1"]'),x=document.querySelector('[data-player="2"]'),_=document.querySelector(".main-container"),w={player1ClickHandler:null,player2ClickHandler:null},k=(e,t,n=!0)=>{const r=e.gameboard.successfulHits,a=e.gameboard.missedShots,o=e.gameboard.getGrid();t.innerHTML="";for(let e=0;e<o.length;e++)for(let s=0;s<o[e].length;s++){const i=document.createElement("div");i.classList.add("player-board__cell"),i.dataset.row=e,i.dataset.column=s,i.addEventListener("dblclick",()=>{const e=i.dataset.shipId;if(!e)return;const t=new CustomEvent("rotate-ship",{detail:{shipId:e},bubbles:!0});i.dispatchEvent(t)});const l=o[e][s],c=`${e},${s}`;r.has(c)&&(i.classList.add("player-board__cell--hit"),i.classList.add("smoke")),a.has(c)&&i.classList.add("player-board__cell--miss"),l&&n&&(i.classList.add("player-board__cell--ship"),i.dataset.shipId=l.id),t.appendChild(i)}},E=(e,t,n,r)=>{const a=document.querySelector(".main-container__game"),o=document.createElement("div");o.classList.add("dock-container");const s=T(e),i=C(t),l=z(n),c=A(r),d=document.createElement("div");d.classList.add("dock-container__actions"),d.append(i,l,c),o.append(s,d),a.append(o)},T=e=>{const t=document.createElement("div");t.classList.add("dock-container__shipyard");const n=Object.values(e);for(const{length:e,type:r}of n){const n=document.createElement("div");n.classList.add("ship","ship--draggable"),n.setAttribute("draggable",!0),n.dataset.type=r,n.dataset.length=e;let a="horizontal",o=0;n.addEventListener("mousedown",e=>{const t=e.target.closest(".ship__segment");o=t?[...t.parentNode.children].indexOf(t):0,n.dataset.offset=o}),n.addEventListener("click",()=>{a="horizontal"===a?"vertical":"horizontal",n.classList.toggle("ship--vertical"),n.dataset.orientation=a}),n.addEventListener("dragstart",t=>{t.dataTransfer.setData("text/ship-type",r),t.dataTransfer.setData("text/ship-length",e),t.dataTransfer.setData("text/orientation",a),t.dataTransfer.setData("text/drag-offset",o),t.dataTransfer.effectAllowed="move",n.classList.add("ship--dragging")}),n.addEventListener("dragend",()=>{n.classList.remove("ship--dragging")});for(let t=0;t<e;t++){const e=document.createElement("div");e.classList.add("ship__segment"),n.appendChild(e)}t.appendChild(n)}return t},L=(e,t,n)=>{const r=document.createElement("button");return r.textContent=e,r.classList.add("battleship__button",`battleship__button--${t}`),r.addEventListener("click",n),r},C=e=>L("Randomize","randomize",e),z=e=>L("Reset","reset",e),A=e=>L("Start","start-game",e),$=e=>{e.querySelectorAll(".player-board__cell").forEach(e=>{e.addEventListener("dragover",e=>{e.preventDefault(),e.dataTransfer.dropEffect="move"}),e.addEventListener("drop",t=>{t.preventDefault();const n=t.dataTransfer.getData("text/ship-type"),r=t.dataTransfer.getData("text/orientation")||"horizontal",a=parseInt(t.dataTransfer.getData("text/drag-offset"))||0;let o=parseInt(e.dataset.row),s=parseInt(e.dataset.column);"horizontal"===r?s-=a:o-=a;const i=new CustomEvent("place-ship",{detail:{shipType:n,startRow:o,startColumn:s,orientation:r},bubbles:!0});e.dispatchEvent(i)})})},M=(e="Drag and place your ships.")=>{const t=document.querySelector(".main-container__message"),n=document.createElement("p");t.innerHTML="",n.textContent=e,t.appendChild(n)},I=(e,t)=>{e.classList.toggle("player-board--attackable",t),e.classList.toggle("player-board--protected",!t)},H=()=>{S.classList.remove("player-board--attackable","player-board--protected"),x.classList.remove("player-board--attackable","player-board--protected")},O=e=>{const t=e.isComputer,n=!e.isComputer;I(S,t),I(x,n)},D=()=>{const e=document.querySelector(".dock-container");e&&e.remove()},B=e=>{if(e){const t=document.querySelector(`.ship--draggable[data-type="${e}"]`);t&&t.remove()}else{document.querySelectorAll(".ship--draggable").forEach(e=>e.remove())}};let N,P,R,G,j;const q={hunting:!1,targetQueue:[],aiTimeoutId:null,attackDelayRange:{hunting:[500,900],searching:[1200,2500]}},F=()=>{Y(),q.hunting=!1,q.targetQueue=[]},Y=()=>{null!==q.aiTimeoutId&&(clearTimeout(q.aiTimeoutId),q.aiTimeoutId=null)},Q=()=>{const[e,t]=q.hunting?q.attackDelayRange.hunting:q.attackDelayRange.searching;return Math.floor(Math.random()*(t-e+1)+e)},U=()=>{if(N.gameHasEnded)return;let e=0;for(;q.hunting&&q.targetQueue.length>0;){const e=q.targetQueue.shift(),[t,n]=e;if(!(!R.gameboard.successfulHits.has(`${t},${n}`)&&!R.gameboard.missedShots.has(`${t},${n}`)))continue;const{success:r,allShipsSunk:a,errorMessage:o,result:s}=_e(P,R,t,n);if(o)return void M(o);if(r)return X(s,t,n),k(R,G),a?(N.winner=P.id,void j()):void Se()}const t=J();for(;e<100;){let n=Math.floor(10*Math.random()),r=Math.floor(10*Math.random());const a=`${n},${r}`;if(!(!R.gameboard.successfulHits.has(a)&&!R.gameboard.missedShots.has(a))||!K(n,r,t)){e++;continue}const{success:o,allShipsSunk:s,errorMessage:i,result:l}=_e(P,R,n,r);if(i)return void M(i);if(o)return X(l,n,r),k(R,G),s?(N.winner=P.id,void j()):void Se()}},X=(e,t,n)=>{if("hit"!==e)return;q.hunting=!0;const r=R.gameboard.getGrid()[t][n],a=V(t,n);q.targetQueue.push(...a),r?.isSunk&&F()},V=(e,t)=>[[e,t-1],[e,t+1],[e-1,t],[e+1,t]].filter(([e,t])=>e>=0&&e<10&&t>=0&&t<10&&!R.gameboard.successfulHits.has(`${e},${t}`)&&!R.gameboard.missedShots.has(`${e},${t}`)),J=()=>Object.values(R.gameboard.fleet).filter(e=>!e.isSunk).map(e=>e.length),K=(e,t,n)=>{for(const r of n){let n=!0,a=!0;for(let o=0;o<r;o++)(t+r>10||R.gameboard.successfulHits.has(`${e},${t+o}`)||R.gameboard.missedShots.has(`${e},${t+o}`))&&(n=!1),(e+r>10||R.gameboard.successfulHits.has(`${e+o},${t}`)||R.gameboard.missedShots.has(`${e+o},${t}`))&&(a=!1);if(n||a)return!0}return!1},W=new v("player1"),Z=new v("player2","Computer",!0),ee=[{type:"carrier",length:5},{type:"battleship",length:4},{type:"destroyer",length:3},{type:"submarine",length:2},{type:"patrolBoat",length:1}],te={currentTurn:null,isFirstTurn:!0,isGameOver:!1,winner:null},ne="You go first! Launch your attack!",re="Enemy has the initiative. Stay sharp.",ae="Opponent's turn.",oe="Your turn.",se="You’ve sunk the enemy fleet. Victory is yours!",ie="All your ships have been destroyed. Defeat!",le="Please place all your ships before starting the game.",ce=(e,t=ee)=>{const n={};return t.forEach(({type:e,length:t})=>{n[e]=new y(e,t)}),e.gameboard.fleet=n,n},de=()=>{const e=ce(W);k(W,S),E(e,me,be,fe),$(S),pe(W,S),M()},pe=(e,t)=>{t.addEventListener("place-ship",n=>{const{shipType:r,startRow:a,startColumn:o,orientation:s}=n.detail;try{const n=e.gameboard.fleet[r];e.gameboard.placeShip(a,o,n,s),B(r),k(e,t),$(t)}catch(e){M(e.message)}}),t.addEventListener("rotate-ship",n=>{const r=n.detail.shipId;he(e.gameboard,r)&&(k(e,t),$(t))})},he=(e,t)=>{const n=e.board,r=[...e.shipPositions].map(e=>e.split(",").map(Number)).filter(([e,r])=>n[e][r]?.id===t);if(0===r.length)return!1;const[a,o]=r[0],s=n[a][o],i=s.orientation,l=s.length,c=n.map(e=>[...e]),d=new Set(e.shipPositions),p=r[0][0]===r[1][0],h=r.sort((e,t)=>p?e[1]-t[1]:e[0]-t[0]),u=Math.floor(l/2),[m,b]=h[u],f=p?"vertical":"horizontal";let g=m,v=b;"horizontal"===f?v=b-u:g=m-u;for(const[t,r]of h)n[t][r]=null,e.shipPositions.delete(`${t},${r}`);try{return e.placeShip(g,v,s,f),!0}catch(t){return e.board=c,e.shipPositions=d,s.orientation=i,M(t.message),!1}},ue=(e,t,n=()=>{})=>{e.gameboard.reset();const r=ce(e);for(const t in r){const n=r[t];let a=!1,o=0;for(;!a&&o<100;){const t=Math.floor(10*Math.random()),r=Math.floor(10*Math.random()),s=Math.random()<.5?"horizontal":"vertical";try{e.gameboard.placeShip(t,r,n,s),a=!0}catch{o++}}}n(),k(e,t)},me=()=>{ue(W,S,B)},be=()=>{W.gameboard.reset(),D();const e=ce(W);k(W,S),E(e,me,be,fe),$(S),te.isFirstTurn=!0},fe=()=>{(()=>{const e=document.querySelector(".dock-container__shipyard");return!!e&&0===e.querySelectorAll(".ship--draggable").length})()?(D(),ve(),M(te.currentTurn===W.id?ne:re),xe(),ge(),P=Z,N=te,R=W,G=S,j=ke,Se(),_.appendChild(L("New Game","new-game",ye))):M(le)},ge=()=>{w.player1ClickHandler&&x.removeEventListener("click",w.player1ClickHandler),w.player2ClickHandler&&S.removeEventListener("click",w.player2ClickHandler),w.player1ClickHandler=we(W,Z,x),w.player2ClickHandler=we(Z,W,S),S.addEventListener("click",w.player2ClickHandler),x.addEventListener("click",w.player1ClickHandler)},ve=()=>{te.currentTurn=Math.random()<.5?W.id:Z.id},ye=()=>{te.currentTurn=null,te.isFirstTurn=!0,te.isGameOver=!1,F(),x&&(x.style.display="none"),H(),W.gameboard.reset(),Z.gameboard.reset(),(()=>{const e=document.querySelector(".battleship__button--new-game");e&&e.remove()})(),ve(),de()},Se=()=>{te.isFirstTurn||(te.currentTurn=te.currentTurn===W.id?Z.id:W.id);const e=te.currentTurn===W.id?W:Z;e.isComputer?(O(e),te.isFirstTurn||M(ae),(e=>{Y();const t=Q();q.aiTimeoutId=setTimeout(e,t)})(U)):(O(e),te.isFirstTurn||M(oe)),te.isFirstTurn=!1},xe=()=>{ue(Z,x),k(Z,x,!1),x.style.display="grid"},_e=(e,t,n,r)=>{if(te.isGameOver||e.id!==te.currentTurn)return{success:!1,allShipsSunk:!1,errorMessage:null};try{const e=t.gameboard.receiveAttack(n,r);return{success:!0,allShipsSunk:t.gameboard.allShipsSunk,errorMessage:null,result:e}}catch(e){return{success:!1,allShipsSunk:!1,errorMessage:e.message}}},we=(e,t,n)=>r=>{const a=r.target;if(!a.classList.contains("player-board__cell"))return;const o=parseInt(a.dataset.row),s=parseInt(a.dataset.column),{success:i,allShipsSunk:l,errorMessage:c}=_e(e,t,o,s);if(c)M(c);else if(i){if(k(t,n,!1),l)return te.winner=e.id,void ke();Se()}},ke=()=>{te.isGameOver||(te.isGameOver=!0,Y(),M("player1"===te.winner?se:ie),H(),x.style.pointerEvents="none",k(Z,x))};de(),(()=>{const e=(new Date).getFullYear(),t=document.createElement("footer");t.classList.add("site-footer"),t.innerHTML=`\n    <p class="site-footer__text">\n      © ${e} Designed and built by ej\n      <a href="https://github.com/krig6" target="_blank" aria-label="GitHub" rel="noopener noreferrer">\n        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 16 16"\n          class="site-footer__icon">\n          <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 \n            2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 \n            0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52\n            -.01-.53.63-.01 1.08.58 1.23.82.72 1.21 \n            1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2\n            -3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15\n            -.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82a7.66 \n            7.66 0 0 1 2-.27c.68 0 1.36.09 2 .27 1.53-1.04 \n            2.2-.82 2.2-.82.44 1.1.16 1.92.08 \n            2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 \n            3.75-3.65 3.95.29.25.54.73.54 1.48 \n            0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 \n            8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z" />\n        </svg>\n      </a>\n    </p>\n      `,document.body.append(t)})()})();